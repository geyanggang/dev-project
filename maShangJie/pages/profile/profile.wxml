<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- 用户信息卡片 -->
  <view class="user-card">
    <image class="avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
    <view class="user-info">
      <view class="nickname">{{userInfo.nickname}}</view>
      <view class="role-badge">
        <text>{{userInfo.userType === 'customer' ? '客户' : '程序员'}}</text>
      </view>
    </view>
    <view class="stats">
      <view class="stat-item">
        <view class="stat-value">{{userInfo.rating || 5.0}}</view>
        <view class="stat-label">评分</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-value">{{userInfo.completedOrders || 0}}</view>
        <view class="stat-label">完成订单</view>
      </view>
    </view>
  </view>

  <!-- 技能标签 (仅程序员) -->
  <view class="card" wx:if="{{userInfo.userType === 'developer'}}">
    <view class="card-title">我的技能</view>
    <view class="skills">
      <view class="tag tag-primary" wx:for="{{userInfo.skills}}" wx:key="index">
        {{item}}
      </view>
    </view>
    <button class="btn-outline mt-20" bindtap="editSkills">编辑技能</button>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-list">
    <view class="menu-item" bindtap="goToMyTasks">
      <view class="menu-left">
        <image src="/images/task.png" mode="aspectFit"></image>
        <text>我的任务</text>
      </view>
      <image class="arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <view class="menu-item" bindtap="goToMyOrders">
      <view class="menu-left">
        <image src="/images/order.png" mode="aspectFit"></image>
        <text>我的订单</text>
      </view>
      <image class="arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <view class="menu-item" bindtap="goToReviews">
      <view class="menu-left">
        <image src="/images/star.png" mode="aspectFit"></image>
        <text>我的评价</text>
      </view>
      <image class="arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <view class="menu-item" bindtap="switchRole">
      <view class="menu-left">
        <image src="/images/switch.png" mode="aspectFit"></image>
        <text>切换身份</text>
      </view>
      <image class="arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>
  </view>

  <!-- 其他功能 -->
  <view class="menu-list mt-20">
    <view class="menu-item" bindtap="showAbout">
      <view class="menu-left">
        <image src="/images/info.png" mode="aspectFit"></image>
        <text>关于我们</text>
      </view>
      <image class="arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>

    <view class="menu-item" bindtap="contactService">
      <view class="menu-left">
        <image src="/images/service.png" mode="aspectFit"></image>
        <text>联系客服</text>
      </view>
      <image class="arrow" src="/images/arrow-right.png" mode="aspectFit"></image>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section">
    <button class="btn-outline logout-btn" bindtap="logout">退出登录</button>
  </view>

  <!-- 编辑技能弹窗 -->
  <view class="popup" wx:if="{{showSkillsPopup}}" bindtap="hideSkillsPopup">
    <view class="popup-content" catchtap="stopPropagation">
      <view class="popup-header">
        <text class="popup-title">编辑技能</text>
        <image src="/images/close.png" bindtap="hideSkillsPopup" mode="aspectFit"></image>
      </view>
      
      <view class="popup-body">
        <view class="skills-selector">
          <view class="tag {{editingSkills.indexOf(item) > -1 ? 'tag-primary' : ''}}"
                wx:for="{{skillOptions}}"
                wx:key="index"
                bindtap="toggleEditSkill"
                data-skill="{{item}}">
            {{item}}
          </view>
        </view>
      </view>

      <view class="popup-footer">
        <button class="btn-outline" bindtap="hideSkillsPopup">取消</button>
        <button class="btn-primary" bindtap="saveSkills">保存</button>
      </view>
    </view>
  </view>
</view>

